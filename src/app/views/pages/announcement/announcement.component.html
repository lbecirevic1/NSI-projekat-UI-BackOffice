<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<c-row class="mt-5">
  <c-col md="1"></c-col>
  <c-col md="10">
    <c-card>
      <c-card-body class="pl-5 shadow">
        <h1>Announcements</h1>
      </c-card-body>
    </c-card>
  </c-col>
</c-row>

<c-row class="mt-3">
  <ng-container *ngTemplateOutlet="liveDemo"></ng-container>
  <ng-container *ngTemplateOutlet="deleteDemo"></ng-container>
  <ng-container *ngTemplateOutlet="createDemo"></ng-container>
  <ng-container *ngTemplateOutlet="scrollableLongContent"></ng-container>
  <ng-container *ngTemplateOutlet="scrollableLongContent2"></ng-container>
  <ng-container *ngTemplateOutlet="scrollableLongContent3"></ng-container>
  <c-col md="1"></c-col>
  <c-col md="10">
    <c-card>
      <c-card-body class="pl-5 ml-5 mt-1 shadow">
        <c-row class="mb-5 ml-5">
          <c-col>
            <h4 cCardTitle>Announcement list</h4>
          </c-col>
          <c-col style="text-align:right">
            <button cButton color="success" (click)="toggleCreateAnnouncementButton()">Add new notification</button>
          </c-col>
        </c-row>

        <c-row class="ml-5 pl-5">
          <table cTable hover>
            <thead>
              <tr class="pt-3 pb-3">
                <!-- <th></th> -->
                <th class="announcement-table-col-13">Provider</th>
                <th class="announcement-table-col-20">Title</th>
                <th class="announcement-table-col-13">Publish date and time</th>
                <th class="announcement-table-col-20">Region</th>
                <!-- <th class="announcement-table-col-10">Streets</th> -->
                <th class="announcement-table-col-10">Action</th>
              </tr>
            </thead>
            <tbody>
            <ng-container *ngFor="let value of notifications; let i = index">
              <tr class="pt-3 pb-3" class="clickable-row" (click)="toggleCollapse(i)">       
                <td class="announcement-table-col-13">{{providerName(value.ProviderId)}}</td>
                <td class="announcement-table-col-20">{{value.Title}}</td>
                <td class="announcement-table-col-13">{{parseDate(value.PublishDate)}}</td>
                <td class="announcement-table-col-20">/</td>
                <!-- <td class="announcement-table-col-10">/</td> -->
                <td class="announcement-table-col-10">
                  <c-button-group aria-label="Basic example" role="group">
                    <button cButton color="light" (click)="toggleEditButtonDemo(value)">Edit</button>
                    <button cButton color="danger" (click)="toggleDeleteButton(value.Id)">Delete</button>
                  </c-button-group>
                </td>      
              </tr>
              <ng-container *ngIf="additionalInfoVisible && indexSelectedCoverage === i" class="card-hidden mb-5">
                <div [visible]="additionalInfoVisible" cCollapse class="card-hidden mb-2 p-2">
                  <h6 class="pb-0 mb-0">Source url</h6>
                  <p class="pb-0 mb-0">{{value.SourceUrl}}</p>
                  <h6 class="pb-0 mb-0">Description</h6>
                  <p class="pb-0 mb-0">{{value.Title}}</p>
                  <h6 class="pb-0 mb-0">Additional Information</h6>
                  <p class="pb-0">{{value.AdditionalInformation}}</p>
                </div>         
              </ng-container>
            </ng-container>
            </tbody>
          </table>
        </c-row>
      </c-card-body>
    </c-card>
  </c-col>
</c-row>

<!-- <c-card>
    <button (click)="toggleCollapse(1)" cButton class="me-1" color="primary">Button</button>
    <c-card [ngClass]="'shadow mt-3'" [visible]="additionalInfoVisible" cCollapse>
      <c-card-body>
        Anim pariatur cliche reprehenderit, enim eiusmod high life accusamus terry
        richardson ad squid. Nihil anim keffiyeh helvetica, craft beer labore wes
        anderson cred nesciunt sapiente ea proident.
      </c-card-body>
    </c-card>
</c-card> -->


<ng-template #liveDemo>
  <c-modal id="liveDemoModal" [visible]="liveDemoVisible" (visibleChange)="handleLiveDemoChange($event)">
    <c-modal-header>
      <h5 cModalTitle>Delete notification</h5>
      <button (click)="closeDeleteButton()" cButtonClose></button>
    </c-modal-header>
    <c-modal-body>Are you sure you want to delete this record?</c-modal-body>
    <c-modal-footer>
      <button (click)="closeDeleteButton()" cButton color="secondary">
        Close
      </button>
      <button cButton color="primary" (click)="deleteItem()">Delete</button>
    </c-modal-footer>
  </c-modal>
</ng-template>

<c-modal id="liveEditForm" [visible]="editFormVisible" (visibleChange)="handleEditModalChange($event)">
  <c-modal-header>
    Edit form
  </c-modal-header>
  <c-modal-body>
    <form cForm *ngIf=editFormVisible>
      <div class="mb-3">
        <label cLabel for="announcementTitleInput1">Title</label>
        <textarea cFormControl id="announcementTitleInput1" rows="1">{{editAnnouncement.Title}}</textarea>
      </div>
      <div class="mb-3">
        <label cLabel for="announcementTitleInput2">Url</label>
        <textarea cFormControl id="announcementTitleInput2" rows="1">{{editAnnouncement.SourceUrl}}</textarea>
      </div>
      <div class="mb-3">
        <label cLabel for="announcementTitleInput3">Description</label>
        <textarea cFormControl id="announcementTitleInput3" rows="1">{{editAnnouncement.Description}}</textarea>
      </div>
      <label cLabel for="announcementTitleInput4">Content</label>
      <div class="mb-3">
        <textarea cFormControl id="announcementTitleInput4" rows="1">{{editAnnouncement.Content}}</textarea>
      </div>
      <div class="mb-3">
        <label cLabel for="announcementTitleInput5">Additional Information</label>
        <textarea cFormControl id="announcementTitleInput5" rows="1">{{editAnnouncement.AdditionalInformation}}</textarea>
      </div>
    </form>
  </c-modal-body>
  <c-modal-footer>
    <button (click)="toggleEditDemo()" cButton color="secondary">
      Close
    </button>
    <button cButton color="primary" >Save changes</button>
  </c-modal-footer>
</c-modal>

<!-- Form for creating new announcement -->
<ng-template #createDemo>
<c-modal id="createForm" [visible]="createFormVisible" (visibleChange)="handleCreateAnnouncement($event)" >
  <c-modal-header>
    Create new announcement
  </c-modal-header>
  <c-modal-body>
      <form #createForm="ngForm" *ngIf=createFormVisible>
        <div class="mb-3">
          <ng-multiselect-dropdown
            [placeholder]="'Providers'"
            [settings]="dropdownSettingsProviders"
            [data]="providers"
            [(ngModel)]="clickedProviders"
            (onSelect)="onProviderSelect($event)"
            (onSelectAll)="onSelectAllProviders($event)"
            (onDeSelect)="onDeselectProviders($event)"
            (onDeSelectAll)="onDeselectAllProviders($event)"
          >
          </ng-multiselect-dropdown>
        </div>
      <div class="mb-3">
        <div class="input-fields">
        <label cLabel for="title">Title</label>
        <input cFormControl id="title" rows="1" name="newAnnouncTitle" type="text" ngModel>
      </div>
      <div class="row">
        <div class="col-md">
          <div class="mb-3 form-outline datetimepicker">
            <label cLabel for="startdatepicker">Start date</label>
            <input cFormControl type="text" value="22/12/2022"  id="startdatepicker"  name="newAnnouncStartDate" ngModel/>
          </div>
        </div>
        <div class="col-md">
          <div class="mb-3 form-outline datetimepicker">
            <label cLabel for="startdatepicker">Start time</label>
            <input cFormControl type="text" value="14:56:03"  id="starttimepicker"  name="newAnnouncStartTime" ngModel/>
          </div>
        </div>
        <div class="col-md">
          <div class="mb-3 form-outline datetimepicker">
            <label cLabel for="enddatepicker">End date</label>
            <input cFormControl type="text" value="22/12/2022" id="enddatepicker" name="newAnnouncEndDate" ngModel/>
          </div>
        </div>
        <div class="col-md">
          <div class="mb-3 form-outline datetimepicker">
            <label cLabel for="enddatepicker">End time</label>
            <input cFormControl type="text" value="14:56:30" id="endtimepicker" name="newAnnouncEndTime" ngModel/>
          </div>
        </div>
      </div>
      <div class="mb-3">
        <label cLabel for="url">Url</label>
        <textarea cFormControl id="url" rows="2" name="newAnnouncUrl" ngModel></textarea>
      </div>
      <div class="mb-3">
        <label cLabel for="description">Description</label>
        <textarea cFormControl id="description" rows="2" name="newAnnouncDescription" ngModel></textarea>
      </div>
      <div class="mb-3">
        <label cLabel for="content">Content</label>
        <textarea cFormControl id="content" rows="3" name="newAnnouncContent" ngModel></textarea>
      </div>
      <div class="mb-3">
        <label cLabel for="additionalInformation">Additional Information</label>
        <textarea cFormControl id="additionalInformation" rows="2"name="newAnnouncAddInfo" ngModel ></textarea>
      </div>
      <div class="mb-2">
        <ng-multiselect-dropdown
          [placeholder]="'Regions'"
          [settings]="dropdownSettingsRegions"
          [data]="regions"
          [(ngModel)]="clickedRegions"
          (onSelect)="onRegionSelect($event)"
          (onSelectAll)="onSelectAllRegions($event)"
          (onDeSelect)="onDeselectRegions($event)"
          (onDeSelectAll)="onDeselectAllRegions($event)"
        >
        </ng-multiselect-dropdown>
      </div>
        <div class="mb-2">
          <ng-multiselect-dropdown
            [placeholder]="'Streets'"
            [settings]="dropdownSettingsStreets"
            [data]="streets"
            [(ngModel)]="clickedStreets"
            (onSelect)="onStreetsSelect($event)"
            (onSelectAll)="onSelectAllStreets($event)"
            (onDeSelect)="onDeselectStreets($event)"
            (onDeSelectAll)="onDeselectAllStreets($event)"
          >
          </ng-multiselect-dropdown>
        </div>
      </div>

    </form>
  </c-modal-body>
  <c-modal-footer>
    <button (click)="toggleCreateAnnouncementButton()" cButton color="secondary">
      Close
    </button>
    <button cButton color="primary" type='submit' (click)="submitForm(createForm.value)">Save changes</button>
  </c-modal-footer>
</c-modal>
</ng-template>


<ng-template #deleteDemo>
  <c-modal id="liveDemoModalAlert" [visible]="doubleAnnouncementVisible">
    <c-modal-header>
      <h5 cModalTitle>Double notification alert</h5>
      <button (click)="doubleAnnouncement()" cButtonClose></button>
    </c-modal-header>
    <c-modal-body>There is the same notification in database.</c-modal-body>
    <c-modal-footer>
      <button (click)="doubleAnnouncement()" cButton color="secondary">
        Close
      </button>
    </c-modal-footer>
  </c-modal>
</ng-template>


<ng-template #scrollableLongContent>
  <!--button [cModalToggle]="scrollableLongContentModal.id" cButton>Desciption</button-->
  <c-modal #scrollableLongContentModal id="scrollableLongContentModal" scrollable [visible]="descriptionDemoVisible" (visibleChange)="handleDescriptionVisible($event)">
    <c-modal-header>
      <h5 cModalTitle>Announcement Description</h5>
      <button [cModalToggle]="scrollableLongContentModal.id" cButtonClose></button>
    </c-modal-header>
    <c-modal-body>
<div>{{announcementDescription}}</div>
    </c-modal-body>
    <c-modal-footer>
      <button [cModalToggle]="scrollableLongContentModal.id" cButton color="secondary">
        Close
      </button>
    </c-modal-footer>
  </c-modal>
</ng-template>


<ng-template #scrollableLongContent2>
  <!--button [cModalToggle]="scrollableLongContentModal.id" cButton>Desciption</button-->
  <c-modal #scrollableLongContentModal id="scrollableAddInfoModal" scrollable [visible]="addInfoDemoVisible" (visibleChange)="handleAddInfoVisible($event)">
    <c-modal-header>
      <h5 cModalTitle>Announcement Additional Information</h5>
      <button [cModalToggle]="scrollableLongContentModal.id" cButtonClose></button>
    </c-modal-header>
    <c-modal-body>
      <div>{{announcementAddInfo}}</div>
    </c-modal-body>
    <c-modal-footer>
      <button [cModalToggle]="scrollableLongContentModal.id" cButton color="secondary">
        Close
      </button>
    </c-modal-footer>
  </c-modal>
</ng-template>


<ng-template #scrollableLongContent3>
  <!--button [cModalToggle]="scrollableLongContentModal.id" cButton>Desciption</button-->
  <c-modal #scrollableLongContentModal id="scrollableContentModal" scrollable [visible]="contentDemoVisible" (visibleChange)="handleContentVisible($event)">
    <c-modal-header>
      <h5 cModalTitle>Announcement Content</h5>
      <button [cModalToggle]="scrollableLongContentModal.id" cButtonClose></button>
    </c-modal-header>
    <c-modal-body>
      <div>{{announcementContent}}</div>
    </c-modal-body>
    <c-modal-footer>
      <button [cModalToggle]="scrollableLongContentModal.id" cButton color="secondary">
        Close
      </button>
    </c-modal-footer>
  </c-modal>
</ng-template>
